\documentclass{report}
\input{../preamble}

\begin{document}

\begin{center}
\textbf{\large Nuclear Engineering 150 -- Discussion Section}\\ 
\textbf{Team Exercise Solutions \#12}
\end{center}

%%%%% PROBLEM 1 %%%%%
\input{disc12_exercise01}

\section*{Problem 1 Solution}


\begin{enumerate}[a)]

\item

 In a symmetric spherical system, the one-speed, steady-state diffusion equation is
$$ -D \lap \phi(r) + \Sigma_a (r) \phi(r) = \nu \Sigma_f(r) \phi(r) + S(r) .$$
For any arbitrary function, $f(r,\theta,\varphi)$, the full Laplacian in spherical coordinates is
$$ \lap f(r,\theta,\varphi) = \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p f}{\p r}\right) +  \frac{1}{r^2 \sin\theta} \frac{\p}{\p \theta}\left(\sin\theta \frac{\p f}{\p \theta}\right) + \frac{1}{r^2 \sin^2 \theta} \frac{\p^2 f}{\p \varphi^2} .$$
If the function $f(r,\theta,\varphi)$ is radially symmetric then $f(r,\theta,\varphi) = f(r)$, and there will be no variation in the $\theta$ or $\varphi$ directions ($\frac{\p f}{\p \theta} = 0$ and $\frac{\p f}{\p \varphi} = 0$).  The second and third terms vanish, and
$$ \lap f(r) = \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p f}{\p r}\right) .$$
We substitute this back into our one-speed, steady-state diffusion equation, using $\phi(r)$ instead of $f(r)$.
$$ -D \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p \phi(r)}{\p r}\right) + \Sigma_a (r) \phi(r) = \nu \Sigma_f(r) \phi(r) + S(r) .$$
Finally, we recognize that our problem has two regions. There is no external source in either, so $S(r) = 0$. Since the regions are homogeneous, the diffusion coefficients and cross sections are constant in each: $D_C$, $\Sigma_{a,C}$, $\nu$, and $\Sigma_f$ in the core; $D_R$ and $\Sigma_{a,R}$ in the reflector. We will define the outer radius of the core as $a$, and the outer radius of the reflector as $\frac{3a}{2}$. Then, our diffusion equations for both regions are:
$$ -D_C \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p \phi(r)}{\p r}\right) + \Sigma_{a,C} \phi(r) = \nu \Sigma_f \phi(r), \quad 0 < r < a \quad\text{(core)} $$
$$ -D_R \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p \phi(r)}{\p r}\right) + \Sigma_{a,R}\phi(r) = 0, \quad a < r < \frac{3a}{2} \quad\text{(reflector)}.$$
For our final solution, we will make two more substitutions, $B_C^2 = \frac{\nu\Sigma_f - \Sigma_{a,C}}{D_C}$ and $L_R^2 = \frac{D_R}{\Sigma_{a,R}}$, to get
$$ \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p \phi(r)}{\p r}\right) - B_C^2 \phi(r) = 0, \quad 0 < r < a \quad\text{(core)} $$
$$ \frac{1}{r^2}\frac{\p}{\p r}\left(r^2 \frac{\p \phi(r)}{\p r}\right) - \frac{1}{L_R^2}\phi(r) = 0, \quad a < r < \frac{3a}{2} \quad\text{(reflector)} .$$
There are also four boundary conditions that accompany these equations. A vacuum boundary condition (where we will use the extrapolated distance $d$ to indicate where the flux goes to zero), a finiteness condition, and two interface conditions (both continuous current and flux at the boundary). 
\begin{align*}
&(1)& \phi(r) &< \infty  						& &\text{(flux finiteness)} \\
&(2)& \phi_R\left(\frac{3a}{2} + d\right) &= 0 	& &\text{(vacuum)} \\
&(3)& \phi_C(a) &= \phi_R(a)					& &\text{(continuous flux)} \\
&(4)& J_C(a) &= J_R(a)							& &\text{(continuous current)}
\end{align*} 

\item

Since the diffusion equation takes a different form in each region, the solutions describing the flux shapes in those regions are also different. In the core, the flux has the functional form
$$ \phi_C(r) = \frac{A_C}{r} \sin\left(B_C r\right) + \frac{B_C}{r} \cos\left(B_C r\right) , \quad 0 < r < a,$$
and in the reflector,
$$ \phi_R(r) = \frac{A_R}{r}\sinh\left(\frac{r+\omega}{L_R}\right) + \frac{B_R}{r} \cosh\left(\frac{r+\omega}{L_R}\right), \quad\quad\quad a < r < \frac{3a}{2} .$$
Here we have included the shift in position of the hyperbolic sines and cosines, which is an equally valid solution to the diffusion equation in the reflector region. The usefulness of this parameter will become apparent shortly.

Imposing our first boundary condition (finite flux everywhere), we notice that the second term in the flux solution for the core goes to infinity as $r$ goes to zero ($\frac{1}{r} \rightarrow \infty$ and $\cos(\kappa r) \rightarrow 1$). For the finiteness condition to be satisfied, we must set $B_C = 0$. Considering the second boundary condition (vacuum outside of the reflector), we have the equation
$$ \phi_R\left(\frac{3a}{2}+d\right) = 0 = \frac{A_R}{\frac{3a}{2}+d}\sinh\left(\frac{\frac{3a}{2}+d+\omega}{L_R}\right) + \frac{B_R}{\frac{3a}{2}+d} \cosh\left(\frac{\frac{3a}{2}+d+\omega}{L_R}\right) .$$
Noting that the hyperbolic cosine never gives a value of zero, we can conclude that $B_R = 0$.  Furthermore, the value of the hyperbolic sine only gives a value of zero when it's argument is equal to zero. To satisfy this, $\omega = -\left(\frac{3a}{2}+d\right)/L_R$.

From these two boundary conditions, our flux shapes simplify to
$$ \phi_C(r) = \frac{A_C}{r} \sin\left(B_C r\right) , \quad 0 < r < a,$$
$$ \phi_R(r) = \frac{A_R}{r}\sinh\left(\frac{r-\left(\frac{3a}{2}+d\right)}{L_R}\right), \quad a < r < \frac{3a}{2} .$$
We now use these simpler equations together with our second two boundary conditions. Starting with the flux continuity equation:
$$ \phi_C(a) = \phi_R(a) $$
$$ \frac{A_C}{a} \sin\left(B_C a\right) = \frac{A_R}{a}\sinh\left(\frac{a-\left(\frac{3a}{2}+d\right)}{L_R}\right) $$
$$ A_C = A_R \frac{\sinh\left(-\frac{a+2d}{2L_R}\right)}{\sin\left(B_C a\right)} .$$

Next we move to the current continuity equation, first writing the condition in terms of flux using Fick's law: 
$$ J_C(a) = J_R(a) $$
$$ -D_C\frac{d}{dr}\phi_C(a) = -D_R\frac{d}{dr}\phi_R(a) .$$
Substituting in our flux equations, 
$$ -D_C\frac{d}{dr}\left(\frac{A_C}{r} \sin\left(B_C r\right)\right)\bigg|_{r=a} = -D_R\frac{d}{dr}\left(\frac{A_R}{r}\sinh\left(\frac{r-\left(\frac{3a}{2}+d\right)}{L_R}\right)\right)\bigg|_{r=a} $$
$$ -D_C \left[\frac{A_C B_C}{r}\cos\left(B_C r\right) - \frac{A_C}{r^2}\sin\left(B_C r\right)\right]_{r=a} = -D_R \left[\frac{A_R}{r L_R}\cosh\left(\frac{r-\left(\frac{3a}{2}+d\right)}{L_R}\right) - \frac{A_R}{r^2}\sinh\left(\frac{r-\left(\frac{3a}{2}+d\right)}{L_R}\right)\right]_{r=a} $$
$$ -A_C D_C \left[\frac{B_C}{a}\cos\left(B_C a\right) - \frac{1}{a^2}\sin\left(B_C a\right)\right] = -A_R D_R \left[\frac{1}{a L_R}\cosh\left(\frac{a-\left(\frac{3a}{2}+d\right)}{L_R}\right) - \frac{1}{a^2}\sinh\left(\frac{a-\left(\frac{3a}{2}+d\right)}{L_R}\right)\right]$$
$$ A_C = A_R \frac{D_R \left[\frac{a}{L_R}\cosh\left(-\frac{a+2d}{2L_R}\right) - \sinh\left(-\frac{a+2d}{2L_R}\right)\right]}{D_C \left[a B_C \cos\left(B_C a\right) - \sin\left(B_C a\right)\right]}.$$
At this point, we may realize that these two continuity boundary conditions have given us two equations where $A_C$ is just proportional to $A_R$. In both cases the factor multiplying $A_R$ is a constant, where $a$, $L_R$, and $B_C$ are known quantities. Intuitively, this means that if our reflected reactor is critical then we may have many different flux magnitudes, but always the same general shape. (In other words, a reactor may be critical with many different neutron populations---this is how reactors can be critical over a range of different power levels---but the general function describing where those neutrons are is always similar.) The answer to the question can the be left as
$$\boxed{\begin{aligned}
\quad \phi_C(r) &= \frac{A}{r} \sin\left(B_C r\right) ,& \quad 0 <& r < a \quad \\
\quad \phi_R(r) &= \frac{A \sin\left(B_C a\right)}{r \sinh\left(-\frac{a+2d}{2L_R}\right)}\sinh\left(\frac{r-\left(\frac{3a}{2}+d\right)}{L_R}\right),& \quad a <& r < \frac{3a}{2} \quad 
\end{aligned}}$$
where we have dropped the subscript from the constant, $A$. \\

\item 

The reflector savings is given by the difference between the critical dimensions of a reflected reactor and a bare reactor of the same shape.
$$ \mathcal{S} = a_{\text{ref}} - a_{\text{bare}} $$
From the previous section, for both equations we found to be true, the two factors multiplying $A_R$ must be equal. While we cannot determine a unique flux magnitude, we can relate the given quantities to find $a$:
$$ \frac{\sinh\left(\frac{a}{L_R}\right)}{\sin\left(B_C a\right)} = \frac{D_R \left[\frac{a}{L_R}\cosh\left(-\frac{a+2d}{2L_R}\right) - \sinh\left(-\frac{a+2d}{2L_R}\right)\right]}{D_C \left[a B_C \cos\left(B_C a\right) - \sin\left(B_C a\right)\right]}.$$
This equation is transcendental and it is impossible to calculate a solution analytically, so instead we must solve it numerically. Though we won't actually perform the numerical calculation here,
$$ a_{\text{ref}} = a .$$

For a bare sphere, $a_{\text{bare}}$ can be found using the geometric buckling (equal to the material buckling which is the same for both cores): 
$$ B_{g,\text{bare}}^2 = B_C^2 = \left(\frac{\pi}{\tilde{a}_{\text{bare}}}\right)^2 .$$
We note $\tilde{a}_{\text{bare}} = a_{\text{bare}} + d_{\text{bare}}$, and 
$$ a_{\text{bare}} = \frac{\pi}{B_C} - d_{\text{bare}} .$$
We plug these in to find the reactor savings.
$$\boxed{ \mathcal{S} = a - \frac{\pi}{B_C} + d_{\text{bare}} }$$
\end{enumerate}



\newpage
%%%%% PROBLEM 2 %%%%%
\input{disc12_exercise02}

\section*{Problem 2 Solution}


\begin{enumerate}[a)]

\item 

The steady-state, continuous energy diffusion equation is
$$ -\nabla D(r,E) \nabla \phi(r,E) + \Sigma_t(r,E) \phi(r,E) = \int_0^{\infty} \Sigma_s(r,E' \rightarrow E)\phi(r,E')\,dE' + \chi(E) \int_0^{\infty} \nu(E') \Sigma_f(r,E')\phi(r,E')\,dE' .$$
As a reminder, the terms are defined as:
\begin{align*}
\textbf{Loss terms (left side)} \qquad\qquad& \\
-\nabla D(r,E) \nabla \phi(r,E)&:\text{ the neutrons with energy }E\text{ streaming from location }r\text{ to any other location} \\
\Sigma_t(r,E) \phi(r,E)&:\text{ the total interaction rate of neutrons with energy }E\text{ at location }r  \\
\textbf{Gain terms (right side)} \qquad\qquad& \\
\int_0^{\infty} \Sigma_s(r,E' \rightarrow E)\phi(r,E')\,dE'&:\text{ the scattering rate of neutrons with any energy }E'\text{ into energy }E\text{ at location }r \\
\chi(E) \int_0^{\infty} \nu(E') \Sigma_f(r,E')\phi(r,E')\,dE'&:\text{ the fission rate of neutrons with any energy }E'\text{ at location }r; \\
& \quad\chi(E)\text{ is the fraction of neutrons produced by fission with energy }E
\end{align*}
It is given that $D$ and $\nu$ are constants, and we are told that the reactor is homogeneous so none of the cross sections depend on $r$. Our diffusion equation simplifies down to
$$\boxed{ -D \lap \phi(r,E) + \Sigma_t(E) \phi(r,E) = \int_0^{\infty} \Sigma_s(E' \rightarrow E)\phi(r,E')\,dE' + \chi(E) \int_0^{\infty} \nu \Sigma_f(E')\phi(r,E')\,dE' }.$$

\item

We are asked to derive the three-group multigroup equation, so we need to find the collective behavior in each group. We can do this by taking the integral of the continuous equation over the energy range corresponding to each group. This process will allow us to take the continuous equation which is valid for all energies (and which may not be able to be solved analytically), and turn it into a discretized form that can be solved either by hand, or more likely, with a computer.

Say we take the integral over some energy group, $g$, spanning energies $E_{g-1}$ to $E_g$ (for the lowest energy group, $E_{g-1} = 0$, and for the highest energy group, $E_g = \infty$). Our equation becomes
\begin{align*}
\int_{E_{g-1}}^{E_g} -D \lap \phi(r,E)\,dE + \int_{E_{g-1}}^{E_g} \Sigma_t(E) \phi(r,E)\,dE = \int_{E_{g-1}}^{E_g} \int_0^{\infty} \Sigma_s(E' &\rightarrow E)\phi(r,E')\,dE'\,dE \\
&+ \int_{E_{g-1}}^{E_g} \chi(E) \int_0^{\infty} \nu \Sigma_f(E')\phi(r,E')\,dE'\,dE .
\end{align*}
We can similarly separate our integrals over $dE'$ on the right side into three intervals, one for each group. We will express our total integral, from $E' = 0$ to $E'=\infty$, as the sum of the integrals over these three intervals, each ranging from $E_{g'-1}$ to $E_{g'}$.
\begin{align*}
\int_{E_{g-1}}^{E_g} -D \lap \phi(r,E)\,dE + \int_{E_{g-1}}^{E_g} \Sigma_t(E) \phi(r,E)\,dE = &\int_{E_{g-1}}^{E_g} \sum_{g'=1}^3 \int_{E_{g'-1}}^{E_{g'}} \Sigma_s(E' \rightarrow E)\phi(r,E')\,dE'\,dE \\
 &+ \int_{E_{g-1}}^{E_g} \chi(E) \sum_{g'=1}^3 \int_{E_{g'-1}}^{E_{g'}} \nu \Sigma_f(E')\phi(r,E')\,dE'\,dE 
\end{align*}
Where neither $D$ nor the Laplacian depend on $E$, we can remove them from the integral in the first term. And, since the only factor in the fission term depending on $E$ is $\chi(E)$, the fraction of fission-born neutrons produced into energy $E$, we can separate it as it's own integral. 
$$ \chi_g = \int_{E_{g-1}}^{E_g} \chi(E)\,dE $$
$\chi_g$ is just the fraction of fission-born neutrons produced in group $g$, the sum of the fraction of fission-born neutrons created in all energies from $E_{g-1}$ to $E_g$. Our diffusion equation simplifies to
\begin{align*}
-D \lap \int_{E_{g-1}}^{E_g} \phi(r,E)\,dE + \int_{E_{g-1}}^{E_g} \Sigma_t(E) \phi(r,E)\,dE = \int_{E_{g-1}}^{E_g} \sum_{g'=1}^3 \int_{E_{g'-1}}^{E_{g'}} \Sigma_s(E' &\rightarrow E)\phi(r,E')\,dE'\,dE \\
 &+ \chi_g \nu \sum_{g'=1}^3 \int_{E_{g'-1}}^{E_{g'}} \Sigma_f(E')\phi(r,E')\,dE' .
\end{align*}
Here we recognize that the total flux in group $g$ is given by
$$ \phi_g(r) = \int_{E_{g-1}}^{E_g} \phi(r,E)\,dE ,$$
and that average cross sections for some energy group are equal to the flux-weighted average of the reaction rate over that group's energy range.
$$ \Sigma_g = \frac{\int_{E_{g-1}}^{E_g} \Sigma(E)\phi(r,E)\,dE}{\int_{E_{g-1}}^{E_g} \phi(r,E)\,dE} = \frac{\int_{E_{g-1}}^{E_g} \Sigma(E)\phi(r,E)\,dE}{\phi_g(r)} $$
Multiplying both sides by $\phi_g$ gives
$$ \Sigma_g \phi_g = \int_{E_{g-1}}^{E_g} \Sigma(E)\phi(E)\,dE ,$$
and so we can simplify all the flux and reaction rate integrals in the diffusion equation.
$$ -D \lap \phi_g(r) + \Sigma_{t,g} \phi_g(r) = \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow g}\phi_{g'}(r) + \chi_g \nu \sum_{g'=1}^3 \Sigma_{f,g'}\phi_{g'}(r) $$
Remember, this is actually a set of three equations, one for each group (1, 2, and 3).
\begin{align*}
-D \lap \phi_1(r) + \Sigma_{t,1} \phi_1(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 1}\phi_{g'}(r) + \chi_1 \nu \sum_{g'=1}^3 \Sigma_{f,g'}\phi_{g'}(r) \\
-D \lap \phi_2(r) + \Sigma_{t,2} \phi_2(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 2}\phi_{g'}(r) + \chi_2 \nu \sum_{g'=1}^3 \Sigma_{f,g'}\phi_{g'}(r) \\
-D \lap \phi_3(r) + \Sigma_{t,3} \phi_3(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 3}\phi_{g'}(r) + \chi_3 \nu \sum_{g'=1}^3 \Sigma_{f,g'}\phi_{g'}(r)
\end{align*}

Now we begin to impose the assumptions of the system. First, fission only produces neutrons in group 1, so $\chi_2 = 0$ and $\chi_3 = 0$. Also fission is only induced in group 3, so $\Sigma_{f,1} = 0$ and $\Sigma_{f,2} = 0$. Our set of equations is now:
\begin{align*}
-D \lap \phi_1(r) + \Sigma_{t,1} \phi_1(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 1}\phi_{g'}(r) + \chi_1 \nu \Sigma_{f,3}\phi_{3}(r) \\
-D \lap \phi_2(r) + \Sigma_{t,2} \phi_2(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 2}\phi_{g'}(r) \\
-D \lap \phi_3(r) + \Sigma_{t,3} \phi_3(r) &= \sum_{g'=1}^3 \Sigma_{s,g' \rightarrow 3}\phi_{g'}(r) 
\end{align*}
There is no upscattering---group 2 can only inscatter (scatter back into group 2) or scatter into group 3; group 3 can only inscatter. The groups are directly coupled, so group 1 can only scatter into group 2. These assumptions mean $\Sigma_{s,1 \rightarrow 3} = 0$, $\Sigma_{s,2 \rightarrow 1} = 0$, $\Sigma_{s,3 \rightarrow 1} = 0$, and $\Sigma_{s,3 \rightarrow 2} = 0$, and our equations (which we now right out explicitly) simplify further:
\begin{align*}
-D \lap \phi_1(r) + \Sigma_{t,1} \phi_1(r) &= \Sigma_{s,1 \rightarrow 1}\phi_1(r) + \chi_1 \nu \Sigma_{f,3}\phi_{3}(r) \\
-D \lap \phi_2(r) + \Sigma_{t,2} \phi_2(r) &= \Sigma_{s,1 \rightarrow 2}\phi_1(r) +\Sigma_{s,2 \rightarrow 2}\phi_2(r) \\
-D \lap \phi_3(r) + \Sigma_{t,3} \phi_3(r) &= \Sigma_{s,2 \rightarrow 3}\phi_{2}(r) + \Sigma_{s,3 \rightarrow 3}\phi_{3}(r).\\
\end{align*}

\item

To form a matrix equation, we will start by writing the multigroup equations suggestively, with everything but fission terms on the left and with our flux terms grouped together:
\begin{align*}
\left(-D \lap + \Sigma_{t,1} - \Sigma_{s,1 \rightarrow 1}\right)&\phi_1(r) && && &&= \chi_1 \nu \Sigma_{f,3}\phi_{3}(r) \\
-\Sigma_{s,1 \rightarrow 2}&\phi_1(r) &+ \left(-D \lap + \Sigma_{t,2} - \Sigma_{s,2 \rightarrow 2}\right)&\phi_2(r) && &&= 0 \\
&&- \Sigma_{s,2 \rightarrow 3}&\phi_{2}(r) &+ \left(-D \lap + \Sigma_{t,3} - \Sigma_{s,3 \rightarrow 3}\right)&\phi_{3}(r) &&= 0 
\end{align*}
In this form, we can more easily see that each term multiplying a flux could be an entry in a 
matrix, with the matrix equation being given by
$$\begin{bmatrix}
-D \lap + \Sigma_{t,1} - \Sigma_{s,1 \rightarrow 1} & 0 & 0 \\
-\Sigma_{s,1 \rightarrow 2} & -D \lap + \Sigma_{t,2} - \Sigma_{s,2 \rightarrow 2} & 0 & \\
0 & - \Sigma_{s,2 \rightarrow 3} & -D \lap + \Sigma_{t,3} - \Sigma_{s,3 \rightarrow 3}
\end{bmatrix}\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3
\end{bmatrix} = \begin{bmatrix}
0 & 0 & \chi_1 \nu \Sigma_{f,3} \\
0 & 0 & 0 \\
0 & 0 & 0
\end{bmatrix}\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3
\end{bmatrix}$$
\end{enumerate}


\end{document}

